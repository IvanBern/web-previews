import"./style-N-00tq4J.js";const h={"+":"add","-":"subtract","*":"multiply",x:"multiply",X:"multiply","/":"divide","÷":"divide",Enter:"equals","=":"equals",Enter_Legacy:"equals",Backspace:"backspace",Delete:"backspace",Escape:"clear","%":"percent","±":"negate",F9:"negate"},c={add:"+",subtract:"−",multiply:"×",divide:"÷"},e={displayValue:"0",firstOperand:null,waitingForSecondOperand:!1,operator:null,expression:""},d=document.getElementById("calculator-display"),F=document.getElementById("calculator-expression"),N=document.querySelector(".calculator__grid"),f=document.querySelector('[data-action="clear"]');function A(t){if(!d)return;const a=(t==null?void 0:t.toString().trim())??"",r=Math.max(a.length,1);let n=1;r>=11?n=.72:r>=10?n=.78:r>=9?n=.84:r>=8?n=.9:r>=7&&(n=.95),d.style.setProperty("--display-scale",`${n}`),d.dataset.length=String(r)}function y(t){const a=typeof t=="string"?t:`${t}`;if(a.length<=11)return a;if(a.includes("e")){const[m,L=""]=a.split("e"),R=Number.parseFloat(m).toPrecision(5).replace(/\.0+$/,"").replace(/\.$/,""),_=L.replace(/^\+/,""),g=`${Number.parseFloat(R)}e${_}`;return g.length<=11?g:g.slice(0,11)}const r=a.startsWith("-"),n=a.includes("."),[i,B=""]=a.split(".");if((r?i.slice(1):i).length>=(r?10:11)){const m=Number(a);return Number.isFinite(m)?y(m.toExponential(6)):"0"}if(!n)return a.slice(0,11);const $=11-i.length-1;if($<=0)return`${i}`.slice(0,11);const O=B.slice(0,$).replace(/0+$/,""),S=O.length>0?`${i}.${O}`:i;return S.length<=11?S:y(Number(a).toExponential(6))}function w(t){if(!Number.isFinite(t))return"0";const a=Math.abs(t);return a!==0&&(a>=1e10||a<1e-9)?t.toExponential(6):Number.isInteger(t)?t.toString():Number.parseFloat(t.toPrecision(12)).toString()}function V(t){return y(w(t))}function s(t){return y(w(t))}function k(){F&&(F.textContent=e.expression)}function o(){f&&(e.displayValue!=="0"||e.firstOperand!==null||e.expression!==""?f.textContent="C":f.textContent="AC")}function u(){if(!d)return;const t=e.displayValue;t.endsWith(".")&&t.length<=11?d.textContent=t:d.textContent=y(t),A(d.textContent??""),k()}function l(t){e.expression=t,k()}function b(){e.displayValue="0",e.firstOperand=null,e.waitingForSecondOperand=!1,e.operator=null,l(""),u(),o()}function M(){if(e.firstOperand===null||e.operator===null){b();return}e.displayValue="0",e.waitingForSecondOperand=!0;const t=c[e.operator]??"";l(`${s(e.firstOperand)} ${t}`.trim()),u(),o()}function x(t){if(e.waitingForSecondOperand)e.displayValue=t,e.waitingForSecondOperand=!1;else{if(e.displayValue.replace("-","").replace(".","").length>=11)return;e.displayValue==="0"?e.displayValue=t:e.displayValue==="-0"?e.displayValue=`-${t}`:e.displayValue+=t}if(e.operator&&e.firstOperand!==null&&!e.waitingForSecondOperand){const a=c[e.operator]??"";l(`${s(e.firstOperand)} ${a} ${e.displayValue}`.trim())}u(),o()}function E(){if(e.waitingForSecondOperand){e.displayValue="0.",e.waitingForSecondOperand=!1,u(),o();return}if(!e.displayValue.includes(".")&&!(e.displayValue.length>=11)){if(e.displayValue==="-0"?e.displayValue="-0.":e.displayValue+=".",e.operator&&e.firstOperand!==null){const t=c[e.operator]??"";l(`${s(e.firstOperand)} ${t} ${e.displayValue}`.trim())}u(),o()}}function I(){const t=Number.parseFloat(e.displayValue);if(!Number.isNaN(t)){if(e.displayValue=V(t/100),e.operator&&e.firstOperand!==null){const a=c[e.operator]??"";l(`${s(e.firstOperand)} ${a} ${e.displayValue}`.trim())}u(),o()}}function v(){if(e.waitingForSecondOperand)e.displayValue="0",e.waitingForSecondOperand=!1;else{const t=e.displayValue.length>1?e.displayValue.slice(0,-1):"0";if(e.displayValue=t==="-"?"0":t,e.displayValue.includes(".")){const a=e.displayValue.replace(/\.0+$/,"").replace(/\.$/,"");e.displayValue=a===""||a==="-"?"0":a}e.displayValue==="-0"&&(e.displayValue="0")}if(e.operator&&e.firstOperand!==null&&!e.waitingForSecondOperand){const t=c[e.operator]??"",a=e.displayValue==="0"&&t?`${s(e.firstOperand)} ${t}`:`${s(e.firstOperand)} ${t} ${e.displayValue}`;l(a.trim())}else e.operator||l("");u(),o()}function C(t,a,r){switch(r){case"add":return t+a;case"subtract":return t-a;case"multiply":return t*a;case"divide":return a===0?Number.NaN:t/a;default:return a}}function q(t){const a=Number.parseFloat(e.displayValue);if(Number.isNaN(a))return;if(e.operator&&e.waitingForSecondOperand){e.operator=t;const n=c[t]??"";l(`${s(e.firstOperand??a)} ${n}`.trim()),o();return}if(e.firstOperand===null)e.firstOperand=a;else if(e.operator){const n=C(e.firstOperand,a,e.operator),i=V(n);e.displayValue=i,e.firstOperand=Number.parseFloat(i)}e.waitingForSecondOperand=!0,e.operator=t;const r=c[t]??"";l(`${s(e.firstOperand)} ${r}`.trim()),u(),o()}function P(){if(e.operator===null||e.firstOperand===null)return;const t=Number.parseFloat(e.displayValue);if(Number.isNaN(t))return;const a=e.operator,r=e.firstOperand,n=C(r,t,a),i=V(n);e.displayValue=i,e.firstOperand=null,e.operator=null,e.waitingForSecondOperand=!1,l(`${s(r)} ${c[a]??""} ${s(t)}`.trim()),u(),o()}function K(){if(e.waitingForSecondOperand)e.displayValue="-0",e.waitingForSecondOperand=!1;else if(e.displayValue.startsWith("-")){const t=e.displayValue.slice(1)||"0";e.displayValue=t==="0"?"0":t}else e.displayValue!=="0"?e.displayValue=`-${e.displayValue}`:e.displayValue="-0";if(e.operator&&e.firstOperand!==null)if(e.waitingForSecondOperand){const t=c[e.operator]??"";l(`${s(e.firstOperand)} ${t}`.trim())}else{const t=c[e.operator]??"";l(`${s(e.firstOperand)} ${t} ${e.displayValue}`.trim())}else l("");u(),o()}function p(t){t&&(t.classList.add("is-pressed"),setTimeout(()=>{t.classList.remove("is-pressed")},120))}function D(t){switch(t){case"clear":f&&f.textContent==="C"?M():b();break;case"percent":I();break;case"decimal":E();break;case"equals":P();break;case"backspace":v();break;case"negate":K();break}}function T(t){const a=t.target.closest("button");if(!a)return;p(a);const r=a.dataset.digit,n=a.dataset.action,i=a.dataset.operator;if(r){x(r);return}if(i){q(i);return}n&&D(n)}function W(t){const{key:a}=t;if(/^[0-9]$/.test(a)){const n=document.querySelector(`[data-digit="${a}"]`);p(n),x(a);return}if(a==="."){const n=document.querySelector('[data-action="decimal"]');p(n),E();return}const r=h[a]??h[`${a}_Legacy`];if(r)if((a==="Backspace"||a==="Delete")&&t.preventDefault(),r==="add"||r==="subtract"||r==="multiply"||r==="divide"){const n=document.querySelector(`[data-operator="${r}"]`);p(n),q(r)}else if(r==="equals"){const n=document.querySelector('[data-action="equals"]');p(n),P()}else{const n=document.querySelector(`[data-action="${r}"]`);p(n),D(r)}}function Y(){return!N||!d?null:(N.addEventListener("click",T),document.addEventListener("keydown",W),u(),o(),{clear:b})}Y();
