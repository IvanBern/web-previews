import"./style-BSEb5Haz.js";const h={"+":"add","-":"subtract","*":"multiply",x:"multiply",X:"multiply","/":"divide","÷":"divide",Enter:"equals","=":"equals",Enter_Legacy:"equals",Backspace:"backspace",Delete:"backspace",Escape:"clear","%":"percent"},u={add:"+",subtract:"−",multiply:"×",divide:"÷"},e={displayValue:"0",firstOperand:null,waitingForSecondOperand:!1,operator:null,expression:""},y=document.getElementById("calculator-display"),F=document.getElementById("calculator-expression"),S=document.querySelector(".calculator__grid"),p=document.querySelector('[data-action="clear"]');function f(t){const r=typeof t=="string"?t:`${t}`;if(r.length<=11)return r;if(r.includes("e")){const[m,L=""]=r.split("e"),R=Number.parseFloat(m).toPrecision(5).replace(/\.0+$/,"").replace(/\.$/,""),_=L.replace(/^\+/,""),g=`${Number.parseFloat(R)}e${_}`;return g.length<=11?g:g.slice(0,11)}const n=r.startsWith("-"),a=r.includes("."),[i,D=""]=r.split(".");if((n?i.slice(1):i).length>=(n?10:11)){const m=Number(r);return Number.isFinite(m)?f(m.toExponential(6)):"0"}if(!a)return r.slice(0,11);const V=11-i.length-1;if(V<=0)return`${i}`.slice(0,11);const O=D.slice(0,V).replace(/0+$/,""),N=O.length>0?`${i}.${O}`:i;return N.length<=11?N:f(Number(r).toExponential(6))}function w(t){if(!Number.isFinite(t))return"0";const r=Math.abs(t);return r!==0&&(r>=1e10||r<1e-9)?t.toExponential(6):Number.isInteger(t)?t.toString():Number.parseFloat(t.toPrecision(12)).toString()}function b(t){return f(w(t))}function l(t){return f(w(t))}function x(){F&&(F.textContent=e.expression)}function o(){p&&(e.displayValue!=="0"||e.firstOperand!==null||e.expression!==""?p.textContent="C":p.textContent="AC")}function s(){if(!y)return;const t=e.displayValue;t.endsWith(".")&&t.length<=11?y.textContent=t:y.textContent=f(t),x()}function c(t){e.expression=t,x()}function $(){e.displayValue="0",e.firstOperand=null,e.waitingForSecondOperand=!1,e.operator=null,c(""),s(),o()}function A(){if(e.firstOperand===null||e.operator===null){$();return}e.displayValue="0",e.waitingForSecondOperand=!0;const t=u[e.operator]??"";c(`${l(e.firstOperand)} ${t}`.trim()),s(),o()}function E(t){if(e.waitingForSecondOperand)e.displayValue=t,e.waitingForSecondOperand=!1;else{if(e.displayValue.replace("-","").replace(".","").length>=11)return;e.displayValue=e.displayValue==="0"?t:e.displayValue+t}if(e.operator&&e.firstOperand!==null&&!e.waitingForSecondOperand){const r=u[e.operator]??"";c(`${l(e.firstOperand)} ${r} ${e.displayValue}`.trim())}s(),o()}function k(){if(e.waitingForSecondOperand){e.displayValue="0.",e.waitingForSecondOperand=!1,s(),o();return}if(!e.displayValue.includes(".")&&!(e.displayValue.length>=11)){if(e.displayValue+=".",e.operator&&e.firstOperand!==null){const t=u[e.operator]??"";c(`${l(e.firstOperand)} ${t} ${e.displayValue}`.trim())}s(),o()}}function I(){const t=Number.parseFloat(e.displayValue);if(!Number.isNaN(t)){if(e.displayValue=b(t/100),e.operator&&e.firstOperand!==null){const r=u[e.operator]??"";c(`${l(e.firstOperand)} ${r} ${e.displayValue}`.trim())}s(),o()}}function M(){if(e.waitingForSecondOperand)e.displayValue="0",e.waitingForSecondOperand=!1;else{const t=e.displayValue.length>1?e.displayValue.slice(0,-1):"0";if(e.displayValue=t==="-"?"0":t,e.displayValue.includes(".")){const r=e.displayValue.replace(/\.0+$/,"").replace(/\.$/,"");e.displayValue=r===""||r==="-"?"0":r}}if(e.operator&&e.firstOperand!==null&&!e.waitingForSecondOperand){const t=u[e.operator]??"",r=e.displayValue==="0"&&t?`${l(e.firstOperand)} ${t}`:`${l(e.firstOperand)} ${t} ${e.displayValue}`;c(r.trim())}else e.operator||c("");s(),o()}function C(t,r,n){switch(n){case"add":return t+r;case"subtract":return t-r;case"multiply":return t*r;case"divide":return r===0?Number.NaN:t/r;default:return r}}function q(t){const r=Number.parseFloat(e.displayValue);if(Number.isNaN(r))return;if(e.operator&&e.waitingForSecondOperand){e.operator=t;const a=u[t]??"";c(`${l(e.firstOperand??r)} ${a}`.trim()),o();return}if(e.firstOperand===null)e.firstOperand=r;else if(e.operator){const a=C(e.firstOperand,r,e.operator),i=b(a);e.displayValue=i,e.firstOperand=Number.parseFloat(i)}e.waitingForSecondOperand=!0,e.operator=t;const n=u[t]??"";c(`${l(e.firstOperand)} ${n}`.trim()),s(),o()}function P(){if(e.operator===null||e.firstOperand===null)return;const t=Number.parseFloat(e.displayValue);if(Number.isNaN(t))return;const r=e.operator,n=e.firstOperand,a=C(n,t,r),i=b(a);e.displayValue=i,e.firstOperand=null,e.operator=null,e.waitingForSecondOperand=!1,c(`${l(n)} ${u[r]??""} ${l(t)}`.trim()),s(),o()}function d(t){t&&(t.classList.add("is-pressed"),setTimeout(()=>{t.classList.remove("is-pressed")},120))}function B(t){switch(t){case"clear":p&&p.textContent==="C"?A():$();break;case"percent":I();break;case"decimal":k();break;case"equals":P();break;case"backspace":M();break}}function K(t){const r=t.target.closest("button");if(!r)return;d(r);const n=r.dataset.digit,a=r.dataset.action,i=r.dataset.operator;if(n){E(n);return}if(i){q(i);return}a&&B(a)}function T(t){const{key:r}=t;if(/^[0-9]$/.test(r)){const a=document.querySelector(`[data-digit="${r}"]`);d(a),E(r);return}if(r==="."){const a=document.querySelector('[data-action="decimal"]');d(a),k();return}const n=h[r]??h[`${r}_Legacy`];if(n)if((r==="Backspace"||r==="Delete")&&t.preventDefault(),n==="add"||n==="subtract"||n==="multiply"||n==="divide"){const a=document.querySelector(`[data-operator="${n}"]`);d(a),q(n)}else if(n==="equals"){const a=document.querySelector('[data-action="equals"]');d(a),P()}else{const a=document.querySelector(`[data-action="${n}"]`);d(a),B(n)}}function v(){return!S||!y?null:(S.addEventListener("click",K),document.addEventListener("keydown",T),s(),o(),{clear:$})}v();
